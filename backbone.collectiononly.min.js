!function(){var t=this;var e=t.Backbone;var i=[];var r=i.push;var n=i.slice;var s=i.splice;var a;if(typeof exports!=="undefined"){a=exports}else{a=t.Backbone={}}a.VERSION="1.0.0";var o=t._;if(!o&&typeof require!=="undefined")o=require("underscore");a.$=t.jQuery||t.Zepto||t.ender||t.$;a.noConflict=function(){t.Backbone=e;return this};a.emulateHTTP=false;a.emulateJSON=false;var u=a.Events={on:function(t,e,i){if(!l(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);r.push({callback:e,context:i,ctx:i||this});return this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var r=this;var n=o.once(function(){r.off(t,n);e.apply(this,arguments)});n._callback=e;return this.on(t,n,i)},off:function(t,e,i){var r,n,s,a,u,h,c,f;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i){this._events={};return this}a=t?[t]:o.keys(this._events);for(u=0,h=a.length;u<h;u++){t=a[u];if(s=this._events[t]){this._events[t]=r=[];if(e||i){for(c=0,f=s.length;c<f;c++){n=s[c];if(e&&e!==n.callback&&e!==n.callback._callback||i&&i!==n.context){r.push(n)}}}if(!r.length)delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=n.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t];var r=this._events.all;if(i)c(i,e);if(r)c(r,arguments);return this},stopListening:function(t,e,i){var r=this._listeners;if(!r)return this;var n=!e&&!i;if(typeof e==="object")i=this;if(t)(r={})[t._listenerId]=t;for(var s in r){r[s].off(e,i,this);if(n)delete this._listeners[s]}return this}};var h=/\s+/;var l=function(t,e,i,r){if(!i)return true;if(typeof i==="object"){for(var n in i){t[e].apply(t,[n,i[n]].concat(r))}return false}if(h.test(i)){var s=i.split(h);for(var a=0,o=s.length;a<o;a++){t[e].apply(t,[s[a]].concat(r))}return false}return true};var c=function(t,e){var i,r=-1,n=t.length,s=e[0],a=e[1],o=e[2];switch(e.length){case 0:while(++r<n)(i=t[r]).callback.call(i.ctx);return;case 1:while(++r<n)(i=t[r]).callback.call(i.ctx,s);return;case 2:while(++r<n)(i=t[r]).callback.call(i.ctx,s,a);return;case 3:while(++r<n)(i=t[r]).callback.call(i.ctx,s,a,o);return;default:while(++r<n)(i=t[r]).callback.apply(i.ctx,e)}};var f={listenTo:"on",listenToOnce:"once"};o.each(f,function(t,e){u[e]=function(e,i,r){var n=this._listeners||(this._listeners={});var s=e._listenerId||(e._listenerId=o.uniqueId("l"));n[s]=e;if(typeof i==="object")r=this;e[t](i,r,this);return this}});u.bind=u.on;u.unbind=u.off;o.extend(a,u);var d=a.Model=function(t,e){var i;var r=t||{};e||(e={});this.cid=o.uniqueId("c");this.attributes={};if(e.collection)this.collection=e.collection;if(e.parse)r=this.parse(r,e)||{};e._attrs=r;if(i=o.result(this,"defaults")){r=o.defaults({},r,i)}this.set(r,e);this.changed={};this.initialize.apply(this,arguments)};o.extend(d.prototype,u,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return o.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return this.get(t)!=null},set:function(t,e,i){var r,n,s,a,u,h,l,c;if(t==null)return this;if(typeof t==="object"){n=t;i=e}else{(n={})[t]=e}i||(i={});if(!this._validate(n,i))return false;s=i.unset;u=i.silent;a=[];h=this._changing;this._changing=true;if(!h){this._previousAttributes=o.clone(this.attributes);this.changed={}}c=this.attributes,l=this._previousAttributes;if(this.idAttribute in n)this.id=n[this.idAttribute];for(r in n){e=n[r];if(!o.isEqual(c[r],e))a.push(r);if(!o.isEqual(l[r],e)){this.changed[r]=e}else{delete this.changed[r]}s?delete c[r]:c[r]=e}if(!u){if(a.length)this._pending=true;for(var f=0,d=a.length;f<d;f++){this.trigger("change:"+a[f],this,c[a[f]],i)}}if(h)return this;if(!u){while(this._pending){this._pending=false;this.trigger("change",this,i)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:true}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,o.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!o.isEmpty(this.changed);return o.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):false;var e,i=false;var r=this._changing?this._previousAttributes:this.attributes;for(var n in t){if(o.isEqual(r[n],e=t[n]))continue;(i||(i={}))[n]=e}return i},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{};if(t.parse===void 0)t.parse=true;var e=this;var i=t.success;t.success=function(r){if(!e.set(e.parse(r,t),t))return false;if(i)i(e,r,t);e.trigger("sync",e,r,t)};T(this,t);return this.sync("read",this,t)},save:function(t,e,i){var r,n,s,a=this.attributes;if(t==null||typeof t==="object"){r=t;i=e}else{(r={})[t]=e}i=o.extend({validate:true},i);if(r&&!i.wait){if(!this.set(r,i))return false}else{if(!this._validate(r,i))return false}if(r&&i.wait){this.attributes=o.extend({},a,r)}if(i.parse===void 0)i.parse=true;var u=this;var h=i.success;i.success=function(t){u.attributes=a;var e=u.parse(t,i);if(i.wait)e=o.extend(r||{},e);if(o.isObject(e)&&!u.set(e,i)){return false}if(h)h(u,t,i);u.trigger("sync",u,t,i)};T(this,i);n=this.isNew()?"create":i.patch?"patch":"update";if(n==="patch")i.attrs=r;s=this.sync(n,this,i);if(r&&i.wait)this.attributes=a;return s},destroy:function(t){t=t?o.clone(t):{};var e=this;var i=t.success;var r=function(){e.trigger("destroy",e,e.collection,t)};t.success=function(n){if(t.wait||e.isNew())r();if(i)i(e,n,t);if(!e.isNew())e.trigger("sync",e,n,t)};if(this.isNew()){t.success();return false}T(this,t);var n=this.sync("delete",this,t);if(!t.wait)r();return n},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||x();if(this.isNew())return t;return t+(t.charAt(t.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(t){return this._validate({},o.extend(t||{},{validate:true}))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=o.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;if(!i)return true;this.trigger("invalid",this,i,o.extend(e||{},{validationError:i}));return false}});var v=["keys","values","pairs","invert","pick","omit"];o.each(v,function(t){d.prototype[t]=function(){var e=n.call(arguments);e.unshift(this.attributes);return o[t].apply(o,e)}});var p=a.Collection=function(t,e){e||(e={});if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,o.extend({silent:true},e))};var g={add:true,remove:true,merge:true};var m={add:true,merge:false,remove:false};o.extend(p.prototype,u,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.defaults(e||{},m))},remove:function(t,e){t=o.isArray(t)?t.slice():[t];e||(e={});var i,r,n,s;for(i=0,r=t.length;i<r;i++){s=this.get(t[i]);if(!s)continue;delete this._byId[s.id];delete this._byId[s.cid];n=this.indexOf(s);this.models.splice(n,1);this.length--;if(!e.silent){e.index=n;s.trigger("remove",s,this,e)}this._removeReference(s)}return this},set:function(t,e){e=o.defaults(e||{},g);if(e.parse)t=this.parse(t,e);if(!o.isArray(t))t=t?[t]:[];var i,n,a,u,h,l;var c=e.at;var f=this.comparator&&c==null&&e.sort!==false;var d=o.isString(this.comparator)?this.comparator:null;var v=[],p=[],m={};var y=e.add,_=e.merge,b=e.remove;var w=!f&&y&&b?[]:false;for(i=0,n=t.length;i<n;i++){if(!(a=this._prepareModel(u=t[i],e)))continue;if(h=this.get(a)){if(b)m[h.cid]=true;if(_){u=u===a?a.attributes:e._attrs;h.set(u,e);if(f&&!l&&h.hasChanged(d))l=true}}else if(y){v.push(a);a.on("all",this._onModelEvent,this);this._byId[a.cid]=a;if(a.id!=null)this._byId[a.id]=a}if(w)w.push(h||a)}if(b){for(i=0,n=this.length;i<n;++i){if(!m[(a=this.models[i]).cid])p.push(a)}if(p.length)this.remove(p,e)}if(v.length||w&&w.length){if(f)l=true;this.length+=v.length;if(c!=null){s.apply(this.models,[c,0].concat(v))}else{if(w)this.models.length=0;r.apply(this.models,w||v)}}if(l)this.sort({silent:true});if(e.silent)return this;for(i=0,n=v.length;i<n;i++){(a=v[i]).trigger("add",a,this,e)}if(l||w&&w.length)this.trigger("sort",this,e);return this},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++){this._removeReference(this.models[i])}e.previousModels=this.models;this._reset();this.add(t,o.extend({silent:true},e));if(!e.silent)this.trigger("reset",this,e);return this},push:function(t,e){t=this._prepareModel(t,e);this.add(t,o.extend({at:this.length},e));return t},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){t=this._prepareModel(t,e);this.add(t,o.extend({at:0},e));return t},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(){return n.apply(this.models,arguments)},get:function(t){if(t==null)return void 0;return this._byId[t.id!=null?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){if(o.isEmpty(t))return e?void 0:[];return this[e?"find":"filter"](function(e){for(var i in t){if(t[i]!==e.get(i))return false}return true})},findWhere:function(t){return this.where(t,true)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");t||(t={});if(o.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(o.bind(this.comparator,this))}if(!t.silent)this.trigger("sort",this,t);return this},sortedIndex:function(t,e,i){e||(e=this.comparator);var r=o.isFunction(e)?e:function(t){return t.get(e)};return o.sortedIndex(this.models,t,r,i)},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{};if(t.parse===void 0)t.parse=true;var e=t.success;var i=this;t.success=function(r){var n=t.reset?"reset":"set";i[n](r,t);if(e)e(i,r,t);i.trigger("sync",i,r,t)};T(this,t);return this.sync("read",this,t)},create:function(t,e){e=e?o.clone(e):{};if(!(t=this._prepareModel(t,e)))return false;if(!e.wait)this.add(t,e);var i=this;var r=e.success;e.success=function(n){if(e.wait)i.add(t,e);if(r)r(t,n,e)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof d){if(!t.collection)t.collection=this;return t}e||(e={});e.collection=this;var i=new this.model(t,e);if(!i._validate(t,e)){this.trigger("invalid",this,t,e);return false}return i},_removeReference:function(t){if(this===t.collection)delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if((t==="add"||t==="remove")&&i!==this)return;if(t==="destroy")this.remove(e,r);if(e&&t==="change:"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];if(e.id!=null)this._byId[e.id]=e}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];o.each(y,function(t){p.prototype[t]=function(){var e=n.call(arguments);e.unshift(this.models);return o[t].apply(o,e)}});var _=["groupBy","countBy","sortBy"];o.each(_,function(t){p.prototype[t]=function(e,i){var r=o.isFunction(e)?e:function(t){return t.get(e)};return o[t](this.models,r,i)}});a.sync=function(t,e,i){var r=b[t];o.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var n={type:r,dataType:"json"};if(!i.url){n.url=o.result(e,"url")||x()}if(i.data==null&&e&&(t==="create"||t==="update"||t==="patch")){n.contentType="application/json";n.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){n.contentType="application/x-www-form-urlencoded";n.data=n.data?{model:n.data}:{}}if(i.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){n.type="POST";if(i.emulateJSON)n.data._method=r;var s=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}if(n.type!=="GET"&&!i.emulateJSON){n.processData=false}if(n.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){n.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var u=i.xhr=a.ajax(o.extend(n,i));e.trigger("request",e,u,i);return u};var b={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};var w=function(t,e){var i=this;var r;if(t&&o.has(t,"constructor")){r=t.constructor}else{r=function(){return i.apply(this,arguments)}}o.extend(r,i,e);var n=function(){this.constructor=r};n.prototype=i.prototype;r.prototype=new n;if(t)o.extend(r.prototype,t);r.__super__=i.prototype;return r};d.extend=p.extend=w;var x=function(){throw new Error('A "url" property or function must be specified')};var T=function(t,e){var i=e.error;e.error=function(r){if(i)i(t,r,e);t.trigger("error",t,r,e)}}}.call(this);
//# sourceMappingURL=backbone.collectiononly.min.map